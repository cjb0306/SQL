Climate Conference Analysis Project
Database: https://www.db-fiddle.com/f/pxMci1sLL945KHKYvpe9W6/1

--CUSTOM QUERY: Which events have the most VIPs?--
SELECT events.event_name
, COUNT(vips.member_id) AS vip_count
FROM events
LEFT JOIN vips
ON events.event_id = vips.event
GROUP BY events.event_id
ORDER BY vip_count DESC;

--LEFT JOIN: List all VIPs and their hotel reservation (if any).--
SELECT vips.last_name
, vips.first_name
, hotels.hotel_name
FROM vips
LEFT JOIN reservations AS res
ON vips.member_id = res.member_id
   LEFT JOIN hotels
   ON res.hotel = hotels.hotel_id
ORDER BY vips.last_name;

--INNER JOIN: All VIPs who RSVPâ€™d for dinner.--
SELECT vips.last_name
, vips.first_name
FROM vips
INNER JOIN reservations AS res
ON vips.member_id = res.member_id
WHERE res.dinner_rsvp = 1
ORDER BY vips.last_name;

--MULTIPLE JOIN: Make a list of VIPs, their associated event, and their hotel.--
SELECT vips.last_name
, vips.first_name
, events.event_name
, hotels.hotel_name
FROM vips
LEFT JOIN events
ON vips.event = events.event_id
    LEFT JOIN reservations AS res 
    ON vips.member_id = res.member_id
        LEFT JOIN hotels
        ON res.hotel = hotels.hotel_id
ORDER BY vips.last_name;

--SELF JOIN: Who provides feedback to whom?--
SELECT reviewer.last_name AS reviewer_id
, reviewee.last_name AS reviewee_id
FROM vips AS reviewer
JOIN vips AS reviewee 
     ON reviewer.provides_feedback_to = reviewee.member_id
ORDER BY reviewer.last_name;

--QUERY WITH SUBQUERY: Which top 5 VIPs have been members longer than the average number of years of all VIPs?--
SELECT last_name, first_name, member_since
FROM vips
WHERE member_since < (
    SELECT AVG(member_since)
    FROM vips)
ORDER BY member_since ASC
LIMIT 5;

--CUSTOM QUERY: Find all events and how many VIPs have a welcome RSVP.--
SELECT events.event_name
, COUNT(res.member_id) AS welcome_attendees
FROM events
LEFT JOIN vips
ON events.event_id = vips.event
     LEFT JOIN reservations AS res 
     ON vips.member_id = res.member_id 
WHERE res.welcome_rsvp = 1
GROUP BY events.event_name
ORDER BY welcome_attendees DESC;
